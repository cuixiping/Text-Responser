(function(k){function e(a,b){return(b||k).querySelector(a)}function v(a){m.innerHTML="";m.appendChild(a);m.reset();return a}function w(a,b){chrome.storage.local.set(a,b)}function x(){chrome.storage.local.get(t,function(a){if((a=a&&a[t])&&a.length){for(var b=0,c=a.length;b<c;b++){var d=f.children[b]||f.appendChild(y.cloneNode(!0)),g=a[b];e("."+p,d).checked=g[p];e("."+q,d).value=z[g[q]]||z[1];e("."+n,d).value=g[n];e("."+r,d).value=g[r];e("."+s,d).value=g[s]}for(;1<c&&f.children.length>c;)u.push(f.removeChild(f.children[c-
1]))}})}function A(){function a(){d.style.opacity="0";l=setTimeout(b,1100)}function b(){l=0;d.className="tip";d.style.display="none"}l&&clearTimeout(l);l=setTimeout(function(){d.className="tip anim";l=setTimeout(a,10)},10)}var f=k.getElementById("patterns"),y=e(".pattern-item",f).cloneNode(!0),m=k.createElement("form"),d=k.getElementById("tip"),u=[],l,B={"\u7cbe\u786e":1,"\u901a\u914d":2,"\u6b63\u5219":3},z={1:"\u7cbe\u786e",2:"\u901a\u914d",3:"\u6b63\u5219"},t="patterns",p="enabled",q="pattern_type",
n="pattern",r="response_type",s="response";(function(){chrome.storage.local.get("inited",function(a){a&&a.inited?x():w({inited:1,patterns:[{pattern:"http://www.google-analytics.com/analytics.js",pattern_type:"extract",response_type:"js",response:"function ga(){}"}]},x)})})();k.body.onclick=function(a){var b=a.target.getAttribute("cmd"),c;"add"==b&&(c=u.pop()||y.cloneNode(!0),v(c),f.appendChild(c),e("."+n,c).focus());if("del"==b){if(2>f.children.length){f.appendChild(v(f.children[0]));return}u.push(f.removeChild(a.target.parentNode))}if("save"==
b){a=[];var b=f.children,l=b.length,g,k,m,h;for(g=0;g<l;g++)c=b[g],k=e("."+n,c).value.trim(),m=B[e("."+q,c).value],k&&m&&(h={},h[p]=e("."+p,c).checked,h[q]=m,h[n]=k,h[r]=e("."+r,c).value,h[s]=e("."+s,c).value,a.push(h));h={};h[t]=a;w(h,function(){d.innerHTML="Saved OK!";d.style.display="block";d.style.opacity="1";d.className="tip";A()})}}})(document);
