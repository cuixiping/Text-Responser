(function(h){function e(a,b){return(b||h).querySelector(a)}function n(a){l.innerHTML="";l.appendChild(a);l.reset();return a}function r(){function a(){d.style.opacity="0";k=setTimeout(b,1100)}function b(){k=0;d.className="tip";d.style.display="none"}k&&clearTimeout(k);k=setTimeout(function(){d.className="tip anim";k=setTimeout(a,10)},10)}var f=h.getElementById("patterns"),p=e(".pattern-item",f).cloneNode(!0),l=h.createElement("form"),d=h.getElementById("tip"),m=[],k,s={"\u7cbe\u786e":1,"\u901a\u914d":2,
"\u6b63\u5219":3},q={1:"\u7cbe\u786e",2:"\u901a\u914d",3:"\u6b63\u5219"};(function(){chrome.storage.local.get("patterns",function(a){if((a=a&&a.patterns)&&a.length){for(var b=0,c=a.length;b<c;b++){var d=f.children[b]||f.appendChild(p.cloneNode(!0)),g=a[b];e(".enabled",d).checked=g.enabled;e(".pattern_type",d).value=q[g.pattern_type]||q[1];e(".pattern",d).value=g.pattern;e(".response_type",d).value=g.response_type;e(".response",d).value=g.response}for(;1<c&&f.children.length>c;)m.push(f.removeChild(f.children[c-
1]))}})})();h.body.onclick=function(a){var b=a.target.getAttribute("cmd"),c;"add"==b&&(c=m.pop()||p.cloneNode(!0),n(c),f.appendChild(c),e(".pattern",c).focus());if("del"==b){if(2>f.children.length){f.appendChild(n(f.children[0]));return}m.push(f.removeChild(a.target.parentNode))}if("save"==b){a=[];var b=f.children,k=b.length,g,h,l;for(g=0;g<k;g++)c=b[g],h=e(".pattern",c).value.trim(),l=s[e(".pattern_type",c).value],h&&l&&a.push({enabled:e(".enabled",c).checked,pattern_type:l,pattern:h,response_type:e(".response_type",
c).value,response:e(".response",c).value});chrome.storage.local.set({patterns:a},function(){d.innerHTML="Saved OK!";d.style.display="block";d.style.opacity="1";d.className="tip";r()})}}})(document);
